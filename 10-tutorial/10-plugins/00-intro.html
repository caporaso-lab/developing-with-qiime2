

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Building your first QIIME 2 plugin &#8212; Developing with QIIME 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '10-tutorial/10-plugins/00-intro';</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Instantiating the qiime2.plugin.Plugin object" href="10-plugin-setup.html" />
    <link rel="prev" title="Introduction" href="../00-intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../00-intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/q2dev.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/q2dev.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../00-intro.html">
                    Developing with QIIME 2
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../00-intro.html">Introduction</a></li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Building your first QIIME 2 plugin</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="10-plugin-setup.html">Instantiating the <cite>qiime2.plugin.Plugin</cite> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="20-registering-actions.html">Registering an Action</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../20-interfaces/00-intro.html">Building your first QIIME 2 interface</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../20-interfaces/10-plugin-manager.html">Instantiating <code class="docutils literal notranslate"><span class="pre">qiime2.sdk.PluginManager</span></code></a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Understanding QIIME 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../20-understanding/00-intro.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../20-understanding/10-plugins/00-intro.html">Understanding QIIME 2 Plugins</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../20-understanding/10-plugins/10-plugin.html">The <code class="docutils literal notranslate"><span class="pre">qiime2.plugin.Plugin</span></code> object</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../20-understanding/20-interfaces/00-intro.html">Understanding QIIME 2 Interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../20-understanding/20-interfaces/10-plugin-manager.html">The <code class="docutils literal notranslate"><span class="pre">qiime2.sdk.PluginManager</span></code> object</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How-to guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../30-how-to/00-intro.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../30-how-to/10-plugins/00-intro.html">Accomplishing specific tasks in QIIME 2 Plugins</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../30-how-to/10-plugins/10-type-mapping.html">Mapping input semantic types to output semantic types</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../30-how-to/20-interfaces/00-intro.html">Accomplishing specific tasks in QIIME 2 Interfaces</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../30-how-to/20-interfaces/10-accessing-help-text.html">Accessing help text on plugins, actions, types, and formats</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../40-reference/00-intro.html">Introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../40-reference/10-api/00-intro.html">QIIME 2 API reference</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../40-reference/10-api/10-usage/00-index.html">Usage API</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../40-reference/10-api/10-usage/10-authors.html">Usage API (for example authors)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../40-reference/10-api/10-usage/20-drivers.html">Usage API (for interface drivers)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../40-reference/10-api/10-usage/30-implementations.html">Premade Usage Drivers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../40-reference/10-api/20-cache/00-index.html">Artifact Cache</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../40-reference/10-api/20-cache/10-cache.html">Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../40-reference/10-api/20-cache/20-pool.html">Pool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../40-reference/90-glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back matter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../99-bibliography.html">List of works cited</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/caporaso-lab/developing-with-qiime2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/caporaso-lab/developing-with-qiime2/issues/new?title=Issue%20on%20page%20%2F10-tutorial/10-plugins/00-intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/10-tutorial/10-plugins/00-intro.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Building your first QIIME 2 plugin</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plugin-components">Plugin components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functionality">Define functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-function-to-register-as-a-method">Create a function to register as a Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-function-to-register-as-a-visualizer">Create a function to register as a Visualizer</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#instantiating-a-plugin">Instantiating a plugin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-an-action">Registering an Action</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-a-method">Registering a Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-a-visualizer">Registering a Visualizer</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-your-plugin-object-as-an-entry-point">Defining your plugin object as an entry point</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-your-plugin-with-q2cli-during-development">Testing your plugin with q2cli during development</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plugin-testing">Plugin testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-plugin-development">Advanced plugin development</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-semantic-types-data-layouts-and-view-readers-writers">Defining semantic types, data layouts, and view readers/writers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-plugins">Example plugins</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="building-your-first-qiime-2-plugin">
<h1>Building your first QIIME 2 plugin<a class="headerlink" href="#building-your-first-qiime-2-plugin" title="Permalink to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document is a work in progress, and serves as basic instructions for creating a QIIME 2 plugin. You can also find some (very preliminary) developer documentation at <a class="reference external" href="https://dev.qiime2.org/latest/">https://dev.qiime2.org</a>.</p>
</div>
<p>Creating a QIIME 2 plugin allows you to provide microbiome analysis functionality to QIIME 2 users. A plugin can be a standalone software project, or you can make a few small additions to your existing software project to make it a QIIME 2 plugin. Creating a single QIIME 2 plugin will make your functionality accessible through any QIIME 2 interface, including the command line interface and the Python 3 API.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>There are several high-level steps to creating a QIIME 2 plugin:</p>
<ol class="arabic simple">
<li><p>A QIIME 2 plugin must define one or more Python 3 functions that will be accessible through QIIME. The plugin must be a Python 3 package that can be installed with <code class="docutils literal notranslate"><span class="pre">setuptools</span></code>.</p></li>
<li><p>The plugin must then instantiate a <code class="docutils literal notranslate"><span class="pre">qiime2.plugin.Plugin</span></code> object and define some information including the name of the plugin and its URL. In the plugin package’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file, this instance will be defined as an entry point.</p></li>
<li><p>The plugin must then register its functions as QIIME 2 <code class="docutils literal notranslate"><span class="pre">Actions</span></code>, which will be accessible to users through any of the QIIME 2 interfaces.</p></li>
<li><p>Optionally, the plugin should be distributed through <a class="reference external" href="https://anaconda.org/">Anaconda</a>, as that will simplify its installation for QIIME 2 users (since that is the supported mechanism for installing QIIME 2).</p></li>
</ol>
<p>These steps are covered in detail below.</p>
<p>Writing a simple QIIME 2 plugin should be a straightforward process. For example, the <a class="reference external" href="https://github.com/qiime2/q2-emperor">q2-emperor</a> plugin, which connects <a class="reference external" href="https://github.com/biocore/emperor">Emperor</a> to QIIME 2, is written in only around 100 lines of code. It is a standalone plugin that defines how and which functionality in Emperor should be accessible through QIIME 2. Plugins will vary in their complexity. For example, a plugin that defines a lot of new functionality would likely be quite a bit bigger. <a class="reference external" href="https://github.com/qiime2/q2-diversity">q2-diversity</a> is a good example of this. Unlike <code class="docutils literal notranslate"><span class="pre">q2-emperor</span></code>, there is some specific functionality (and associated unit tests) defined in this project, and it depends on several other Python 3 compatible libraries.</p>
<p>Before starting to write a plugin, you should install QIIME 2 and some plugins to familiarize yourself with the system and to provide a means for testing your plugin.</p>
</section>
<section id="plugin-components">
<h2>Plugin components<a class="headerlink" href="#plugin-components" title="Permalink to this heading">#</a></h2>
<p>The following discussion will refer to the <a class="reference external" href="https://github.com/qiime2/q2-diversity">q2-diversity</a> plugin as an example. This plugin can serve as a reference as you define your own QIIME 2 plugins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>QIIME 2 does not place restrictions on how a plugin package is structured.</strong> The <a class="reference external" href="https://github.com/qiime2/q2-diversity">q2-diversity</a> plugin is however a good representative of the conventions present in many of the initial QIIME 2 plugins. This package structure is simply a recommendation and a starting point for developing your own plugin; feel free to deviate from this structure as necessary or desired.</p>
</div>
<section id="define-functionality">
<h3>Define functionality<a class="headerlink" href="#define-functionality" title="Permalink to this heading">#</a></h3>
<p>QIIME 2 users will access your functionality as QIIME 2 <code class="docutils literal notranslate"><span class="pre">Actions</span></code>. These <code class="docutils literal notranslate"><span class="pre">Actions</span></code> can be either <code class="docutils literal notranslate"><span class="pre">Methods</span></code> or <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>. A <code class="docutils literal notranslate"><span class="pre">Method</span></code> is an operation that takes some combination of <code class="docutils literal notranslate"><span class="pre">Artifacts</span></code> and <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> as input, and produces one or more <code class="docutils literal notranslate"><span class="pre">Artifacts</span></code> as output. These output <code class="docutils literal notranslate"><span class="pre">Artifacts</span></code> could subsequently be used as input to other QIIME 2 <code class="docutils literal notranslate"><span class="pre">Methods</span></code> or <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>. A <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code> is an operation that takes some combination of <code class="docutils literal notranslate"><span class="pre">Artifacts</span></code> and <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> as input, and produces exactly one <code class="docutils literal notranslate"><span class="pre">Visualization</span></code> as output. Output <code class="docutils literal notranslate"><span class="pre">Visualizations</span></code>, by definition, cannot be used as input to other QIIME 2 <code class="docutils literal notranslate"><span class="pre">Methods</span></code> or <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>. <code class="docutils literal notranslate"><span class="pre">Methods</span></code> therefore can produce intermediate or terminal output in a QIIME analysis, while <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code> can only create terminal output.</p>
<p>This section will describe how to define Python 3 functions that can be converted to QIIME 2 <code class="docutils literal notranslate"><span class="pre">Methods</span></code> or <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>. These functions can be defined anywhere in your project; QIIME doesn’t put restrictions on how your plugin package is structured.</p>
<section id="create-a-function-to-register-as-a-method">
<h4>Create a function to register as a Method<a class="headerlink" href="#create-a-function-to-register-as-a-method" title="Permalink to this heading">#</a></h4>
<p>A function that can be registered as a <code class="docutils literal notranslate"><span class="pre">Method</span></code> will have a Python 3 API, and the inputs and outputs for that function will be annotated with their data types using <a class="reference external" href="http://mypy-lang.org/">mypy</a> syntax. mypy annotation does not impact functionality (though the syntax is new to Python 3), so these can be added to existing functions in your Python 3 software project. An example is <code class="docutils literal notranslate"><span class="pre">q2_diversity.beta_phylogenetic</span></code>, which takes a <code class="docutils literal notranslate"><span class="pre">biom.Table</span></code>, an <code class="docutils literal notranslate"><span class="pre">skbio.TreeNode</span></code> and a <code class="docutils literal notranslate"><span class="pre">str</span></code> as input, and produces an <code class="docutils literal notranslate"><span class="pre">skbio.DistanceMatrix</span></code> as output. The signature for this function is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">beta_phylogenetic</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="n">biom</span><span class="o">.</span><span class="n">Table</span><span class="p">,</span> <span class="n">phylogeny</span><span class="p">:</span> <span class="n">skbio</span><span class="o">.</span><span class="n">TreeNode</span><span class="p">,</span>
                      <span class="n">metric</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">skbio</span><span class="o">.</span><span class="n">DistanceMatrix</span><span class="p">:</span>
</pre></div>
</div>
<p>As far as QIIME is concerned, it doesn’t matter what happens inside this function (as long as it adheres to the contract defined by the signature regarding the input and output types). For example, <code class="docutils literal notranslate"><span class="pre">q2_diversity.beta_phylogenetic</span></code> is making some calls to the <code class="docutils literal notranslate"><span class="pre">skbio</span></code> and <code class="docutils literal notranslate"><span class="pre">biom</span></code> APIs, but it could be doing anything, including making system calls (if your plugin is wrapping a command line application), executing an R library, etc.</p>
</section>
<section id="create-a-function-to-register-as-a-visualizer">
<h4>Create a function to register as a Visualizer<a class="headerlink" href="#create-a-function-to-register-as-a-visualizer" title="Permalink to this heading">#</a></h4>
<p>Defining a function that can be registered as a <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code> is very similar to defining one that can be registered as a <code class="docutils literal notranslate"><span class="pre">Method</span></code> with a few additional requirements.</p>
<p>First, the first parameter to this function must be <code class="docutils literal notranslate"><span class="pre">output_dir</span></code>. This parameter should be annotated with type <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
<p>Next, at least one <code class="docutils literal notranslate"><span class="pre">index.*</span></code> file must be written to <code class="docutils literal notranslate"><span class="pre">output_dir</span></code> by the function. This index file will provide the starting point for your users to explore the <code class="docutils literal notranslate"><span class="pre">Visualization</span></code> object that is generated by the <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code>. Index files with different extensions can be created by the function (e.g., <code class="docutils literal notranslate"><span class="pre">index.html</span></code>, <code class="docutils literal notranslate"><span class="pre">index.tsv</span></code>, <code class="docutils literal notranslate"><span class="pre">index.png</span></code>), but at least one must be created. You can write whatever files you want to <code class="docutils literal notranslate"><span class="pre">output_dir</span></code>, including tables, graphics, and textual descriptions of the results, but you should expect that your users will want to find those files through your index file(s). If your function does create many different files, an <code class="docutils literal notranslate"><span class="pre">index.html</span></code> containing links to those files is likely to be helpful.</p>
<p>Finally, the function cannot return anything, and its return type should be annotated as <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">q2_diversity.alpha_group_significance</span></code> is an example of a function that can be registered as a <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code>. In addition to its <code class="docutils literal notranslate"><span class="pre">output_dir</span></code>, it takes alpha diversity results in a <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code> and sample metadata in a <code class="docutils literal notranslate"><span class="pre">qiime2.Metadata</span></code> object and creates several different files (figures and tables) that are linked and/or presented in an <code class="docutils literal notranslate"><span class="pre">index.html</span></code> file. The signature of this function is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">alpha_group_significance</span><span class="p">(</span><span class="n">output_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alpha_diversity</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
                             <span class="n">metadata</span><span class="p">:</span> <span class="n">qiime2</span><span class="o">.</span><span class="n">Metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</pre></div>
</div>
</section>
</section>
<section id="instantiating-a-plugin">
<h3>Instantiating a plugin<a class="headerlink" href="#instantiating-a-plugin" title="Permalink to this heading">#</a></h3>
<p>The next step is to instantiate a QIIME 2 <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> object. This might look like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiime2.plugin</span> <span class="kn">import</span> <span class="n">Plugin</span>
<span class="kn">import</span> <span class="nn">q2_diversity</span>

<span class="n">plugin</span> <span class="o">=</span> <span class="n">Plugin</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;diversity&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="n">q2_diversity</span><span class="o">.</span><span class="n">__version__</span><span class="p">,</span>
    <span class="n">website</span><span class="o">=</span><span class="s1">&#39;https://qiime2.org&#39;</span><span class="p">,</span>
    <span class="n">user_support_text</span><span class="o">=</span><span class="s1">&#39;https://forum.qiime2.org&#39;</span><span class="p">,</span>
    <span class="n">package</span><span class="o">=</span><span class="s1">&#39;q2_diversity&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This will provide QIIME with essential information about your <code class="docutils literal notranslate"><span class="pre">Plugin</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter is the name that users will use to access your plugin from within different QIIME 2 interfaces. It should be a “command line friendly” name, so should not contain spaces or punctuation. (Avoiding uppercase characters and using dashes (<code class="docutils literal notranslate"><span class="pre">-</span></code>) instead of underscores (<code class="docutils literal notranslate"><span class="pre">_</span></code>) are preferable in the plugin <code class="docutils literal notranslate"><span class="pre">name</span></code>, but not required).</p>
<p><code class="docutils literal notranslate"><span class="pre">version</span></code> should be the version number of your package (the same that is used in its <code class="docutils literal notranslate"><span class="pre">setup.py</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">website</span></code> should be the page where you’d like end users to refer for more information about your package. Since <code class="docutils literal notranslate"><span class="pre">q2-diversity</span></code> doesn’t have its own website, we’re including the QIIME 2 website here.</p>
<p><code class="docutils literal notranslate"><span class="pre">package</span></code> should be the Python package name for your plugin.</p>
<p>While not shown in the previous example, plugin developers can optionally provide the following parameters to <code class="docutils literal notranslate"><span class="pre">qiime2.plugin.Plugin</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">citation_text</span></code>: free text describing how users should cite the plugin and/or the underlying tools it wraps. If not provided, users are told to cite the <code class="docutils literal notranslate"><span class="pre">website</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_support_text</span></code>: free text describing how users should get help with the plugin (e.g. issue tracker, StackOverflow tag, mailing list, etc.). If not provided, users are referred to the <code class="docutils literal notranslate"><span class="pre">website</span></code> for support. <code class="docutils literal notranslate"><span class="pre">q2-diversity</span></code> is supported on the QIIME 2 Forum, so we include that URL here. We encourage plugin developers to support their plugins on the QIIME 2 Forum, so you can include that URL as the <code class="docutils literal notranslate"><span class="pre">user_support_text</span></code> for your plugin. If you do that, you should get in the habit of monitoring the QIIME 2 Forum for technical support questions.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> object can live anywhere in your project, but by convention it will be in a file called <code class="docutils literal notranslate"><span class="pre">plugin_setup.py</span></code>. For an example, see <code class="docutils literal notranslate"><span class="pre">q2_diversity/plugin_setup.py</span></code>.</p>
</section>
<section id="registering-an-action">
<h3>Registering an Action<a class="headerlink" href="#registering-an-action" title="Permalink to this heading">#</a></h3>
<p>Once you have functions that you’d like to register as <code class="docutils literal notranslate"><span class="pre">Actions</span></code> (i.e., either <code class="docutils literal notranslate"><span class="pre">Methods</span></code> or <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>), and you’ve instantiated your <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> object, you are ready to register those functions. This will likely be done in the file where the <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> object was instantiated, as it will use that instance (which will be referred to as <code class="docutils literal notranslate"><span class="pre">plugin</span></code> in the following examples).</p>
<section id="registering-a-method">
<h4>Registering a Method<a class="headerlink" href="#registering-a-method" title="Permalink to this heading">#</a></h4>
<p>First we’ll register a <code class="docutils literal notranslate"><span class="pre">Method</span></code> by calling <code class="docutils literal notranslate"><span class="pre">plugin.methods.register_function</span></code> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">q2_types</span> <span class="kn">import</span> <span class="p">(</span><span class="n">FeatureTable</span><span class="p">,</span> <span class="n">Frequency</span><span class="p">,</span> <span class="n">Phylogeny</span><span class="p">,</span>
                      <span class="n">Rooted</span><span class="p">,</span> <span class="n">DistanceMatrix</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">qiime2.plugin</span> <span class="kn">import</span> <span class="n">Str</span><span class="p">,</span> <span class="n">Choices</span><span class="p">,</span> <span class="n">Properties</span><span class="p">,</span> <span class="n">Metadata</span>

<span class="kn">import</span> <span class="nn">q2_diversity</span>
<span class="kn">import</span> <span class="nn">q2_diversity._beta</span> <span class="k">as</span> <span class="nn">beta</span>

<span class="n">plugin</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">register_function</span><span class="p">(</span>
    <span class="n">function</span><span class="o">=</span><span class="n">q2_diversity</span><span class="o">.</span><span class="n">beta_phylogenetic</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;table&#39;</span><span class="p">:</span> <span class="n">FeatureTable</span><span class="p">[</span><span class="n">Frequency</span><span class="p">],</span>
            <span class="s1">&#39;phylogeny&#39;</span><span class="p">:</span> <span class="n">Phylogeny</span><span class="p">[</span><span class="n">Rooted</span><span class="p">]},</span>
    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="n">Str</span> <span class="o">%</span> <span class="n">Choices</span><span class="p">(</span><span class="n">beta</span><span class="o">.</span><span class="n">phylogenetic_metrics</span><span class="p">())},</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;distance_matrix&#39;</span><span class="p">,</span> <span class="n">DistanceMatrix</span> <span class="o">%</span> <span class="n">Properties</span><span class="p">(</span><span class="s1">&#39;phylogenetic&#39;</span><span class="p">))],</span>
    <span class="n">input_descriptions</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;table&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;The feature table containing the samples over which beta &#39;</span>
                  <span class="s1">&#39;diversity should be computed.&#39;</span><span class="p">),</span>
        <span class="s1">&#39;phylogeny&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;Phylogenetic tree containing tip identifiers that &#39;</span>
                      <span class="s1">&#39;correspond to the feature identifiers in the table. &#39;</span>
                      <span class="s1">&#39;This tree can contain tip ids that are not present in &#39;</span>
                      <span class="s1">&#39;the table, but all feature ids in the table must be &#39;</span>
                      <span class="s1">&#39;present in this tree.&#39;</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="n">parameter_descriptions</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;metric&#39;</span><span class="p">:</span> <span class="s1">&#39;The beta diversity metric to be computed.&#39;</span>
    <span class="p">},</span>
    <span class="n">output_descriptions</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;distance_matrix&#39;</span><span class="p">:</span> <span class="s1">&#39;The resulting distance matrix.&#39;</span><span class="p">},</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Beta diversity (phylogenetic)&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Computes a user-specified phylogenetic beta diversity metric&quot;</span>
                 <span class="s2">&quot; for all pairs of samples in a feature table.&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The values being provided are:</p>
<p><code class="docutils literal notranslate"><span class="pre">function</span></code>: The function to be registered as a method.</p>
<p><code class="docutils literal notranslate"><span class="pre">inputs</span></code>: A dictionary indicating the parameter name and its <em>semantic type</em>, for each input <code class="docutils literal notranslate"><span class="pre">Artifact</span></code>. These semantic types differ from the data types that you provided in your <a class="reference external" href="http://mypy-lang.org/">mypy</a> annotation of the input, as semantic types describe the data, where the data types indicate the structure of the data. The currently available semantic types can be viewed by running <code class="docutils literal notranslate"><span class="pre">qiime</span> <span class="pre">tools</span> <span class="pre">import</span> <span class="pre">--show-importable-types</span></code> (until merge of <a class="reference external" href="https://github.com/qiime2/q2cli/pull/291">this PR</a>, which will improve on how this information is accessed from the command line). In the example above we’re indicating that the <code class="docutils literal notranslate"><span class="pre">table</span></code> parameter must be a <code class="docutils literal notranslate"><span class="pre">FeatureTable</span></code> of <code class="docutils literal notranslate"><span class="pre">Frequency</span></code> (i.e. counts), and that the <code class="docutils literal notranslate"><span class="pre">phylogeny</span></code> parameter must be a <code class="docutils literal notranslate"><span class="pre">Phylogeny</span></code> that is <code class="docutils literal notranslate"><span class="pre">Rooted</span></code>.  Notice that the keys in <code class="docutils literal notranslate"><span class="pre">inputs</span></code> map directly to the parameter names in <code class="docutils literal notranslate"><span class="pre">q2_diversity.beta_phylogenetic</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">parameters</span></code>: A dictionary indicating the parameter name and its <em>semantic type</em>, for each input <code class="docutils literal notranslate"><span class="pre">Parameter</span></code>. These parameters are primitive values (i.e., non-<code class="docutils literal notranslate"><span class="pre">Artifacts</span></code>). In the example above, we’re indicating that the <code class="docutils literal notranslate"><span class="pre">metric</span></code> should be a string from a specific set (in this case, the set of known phylogenetic beta diversity metrics).</p>
<p><code class="docutils literal notranslate"><span class="pre">outputs</span></code>: A list of tuples indicating each output name and its semantic type.</p>
<p><code class="docutils literal notranslate"><span class="pre">input_descriptions</span></code>: A dictionary containing input artifact names and their corresponding descriptions. This information is used by interfaces to instruct users how to use each specific input artifact.</p>
<p><code class="docutils literal notranslate"><span class="pre">parameter_descriptions</span></code>: A dictionary containing parameter names and their corresponding descriptions. This information is used by interfaces to instruct users how to use each specific input parameter. You should not include any default parameter values in these descriptions, as these will generally be added automatically by an interface.</p>
<p><code class="docutils literal notranslate"><span class="pre">output_descriptions</span></code>: A dictionary containing output artifact names and their corresponding descriptions. This information is used by interfaces to inform users what each specific output artifact will be.</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code>: A human-readable name for the <code class="docutils literal notranslate"><span class="pre">Method</span></code>. This may be presented to users in interfaces.</p>
<p><code class="docutils literal notranslate"><span class="pre">description</span></code>: A human-readable description of the <code class="docutils literal notranslate"><span class="pre">Method</span></code>. This may be presented to users in interfaces.</p>
</section>
<section id="registering-a-visualizer">
<h4>Registering a Visualizer<a class="headerlink" href="#registering-a-visualizer" title="Permalink to this heading">#</a></h4>
<p>Registering <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code> is the same as registering <code class="docutils literal notranslate"><span class="pre">Methods</span></code>, with two exceptions.</p>
<p>First, you call <code class="docutils literal notranslate"><span class="pre">plugin.visualizers.register_function</span></code> to register a <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code>.</p>
<p>Next, you do not provide <code class="docutils literal notranslate"><span class="pre">outputs</span></code> or <code class="docutils literal notranslate"><span class="pre">output_descriptions</span></code> when making this call, as <code class="docutils literal notranslate"><span class="pre">Visualizers</span></code>, by definition, only return a single visualization. Since the visualization output path is a required parameter, you do not include this in an <code class="docutils literal notranslate"><span class="pre">outputs</span></code> list (it would be the same for every <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code> that was ever registered, so it is added automatically).</p>
<p>Registering <code class="docutils literal notranslate"><span class="pre">q2_diversity.alpha_group_significance</span></code> as a <code class="docutils literal notranslate"><span class="pre">Visualizer</span></code> looks like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plugin</span><span class="o">.</span><span class="n">visualizers</span><span class="o">.</span><span class="n">register_function</span><span class="p">(</span>
    <span class="n">function</span><span class="o">=</span><span class="n">q2_diversity</span><span class="o">.</span><span class="n">alpha_group_significance</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha_diversity&#39;</span><span class="p">:</span> <span class="n">SampleData</span><span class="p">[</span><span class="n">AlphaDiversity</span><span class="p">]},</span>
    <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="n">Metadata</span><span class="p">},</span>
    <span class="n">input_descriptions</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;alpha_diversity&#39;</span><span class="p">:</span> <span class="s1">&#39;Vector of alpha diversity values by sample.&#39;</span>
    <span class="p">},</span>
    <span class="n">parameter_descriptions</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="s1">&#39;The sample metadata.&#39;</span>
    <span class="p">},</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Alpha diversity comparisons&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Visually and statistically compare groups of alpha diversity&quot;</span>
                 <span class="s2">&quot; values.&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="defining-your-plugin-object-as-an-entry-point">
<h3>Defining your plugin object as an entry point<a class="headerlink" href="#defining-your-plugin-object-as-an-entry-point" title="Permalink to this heading">#</a></h3>
<p>Finally, you need to tell QIIME where to find your instantiated <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> object. This is done by defining it as an <code class="docutils literal notranslate"><span class="pre">entry_point</span></code> in your project’s <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> file. In <code class="docutils literal notranslate"><span class="pre">q2-diversity</span></code>, this is done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">setup</span><span class="p">(</span>
    <span class="o">...</span>
    <span class="n">entry_points</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;qiime2.plugins&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;q2-diversity=q2_diversity.plugin_setup:plugin&#39;</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The relevant key in the <code class="docutils literal notranslate"><span class="pre">entry_points</span></code> dictionary will be <code class="docutils literal notranslate"><span class="pre">'qiime2.plugins'</span></code>, and the value will be a single element list containing a string formatted as <code class="docutils literal notranslate"><span class="pre">&lt;distribution-name&gt;=&lt;import-path&gt;:&lt;instance-name&gt;</span></code>. <code class="docutils literal notranslate"><span class="pre">&lt;distribution-name&gt;</span></code> is the name of the Python package distribution (matching the value passed for <code class="docutils literal notranslate"><span class="pre">name</span></code> in this call to <code class="docutils literal notranslate"><span class="pre">setup</span></code>); <code class="docutils literal notranslate"><span class="pre">&lt;import-path&gt;</span></code> is the import path for the <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> instance you created above; and <code class="docutils literal notranslate"><span class="pre">&lt;instance-name&gt;</span></code> is the name for the <code class="docutils literal notranslate"><span class="pre">Plugin</span></code> instance you created above.</p>
</section>
</section>
<section id="testing-your-plugin-with-q2cli-during-development">
<h2>Testing your plugin with q2cli during development<a class="headerlink" href="#testing-your-plugin-with-q2cli-during-development" title="Permalink to this heading">#</a></h2>
<p>If you are testing your plugin with <code class="docutils literal notranslate"><span class="pre">q2cli</span></code> (i.e. the <code class="docutils literal notranslate"><span class="pre">qiime</span></code> command) while you are developing it, you’ll need to run <code class="docutils literal notranslate"><span class="pre">qiime</span> <span class="pre">dev</span> <span class="pre">refresh-cache</span></code> to see the latest changes to your plugin reflected in the command line interface (CLI). You’ll need to run this command anytime you modify your plugin’s interface (e.g. add/rename/remove a command or its inputs/parameters/outputs, and edit any of the plugin/action/input/parameter/output descriptions).</p>
<p>Another option is to set the environment variable <code class="docutils literal notranslate"><span class="pre">Q2CLIDEV=1</span></code> so that the cache is refreshed every time a command is run. This will slow down the CLI while developing because refreshing the cache is slow. However, the CLI is much faster when a user installs release versions of QIIME 2 and plugins, so this slowdown should only be apparent when <em>developing</em> a plugin.</p>
<p>This manual refreshing of the <code class="docutils literal notranslate"><span class="pre">q2cli</span></code> cache is necessary because it can’t detect when changes are made to a plugin’s code while under development (the plugin’s version remains the same across code edits). This manual refreshing of the cache should only be necessary while developing a plugin; when users install QIIME 2 and your released plugin (i.e. no longer in development), the cache will automatically be updated when necessary.</p>
</section>
<section id="plugin-testing">
<h2>Plugin testing<a class="headerlink" href="#plugin-testing" title="Permalink to this heading">#</a></h2>
<p>Many of the QIIME 2 plugins, including <a class="reference external" href="https://github.com/qiime2/q2-emperor">q2-emperor</a> and <a class="reference external" href="https://github.com/qiime2/q2-diversity">q2-diversity</a>, have continuous integration (CI) configuration for <a class="reference external" href="https://travis-ci.org/">Travis-CI</a> in their software repositories. This allows for automated testing any time a change to the plugin code is committed on GitHub if Travis-CI is enabled on the plugin’s software repository. Plugin CI testing generally includes <code class="docutils literal notranslate"><span class="pre">flake8</span></code> linting/style-checking and a <code class="docutils literal notranslate"><span class="pre">nose</span></code> or <code class="docutils literal notranslate"><span class="pre">py.test</span></code> command for running unit tests.</p>
<p>Plugin developers are encouraged to add unit tests for their plugin’s functionality, and to perform style checking with <code class="docutils literal notranslate"><span class="pre">flake8</span></code>. Unit tests are an important part of determining if your software is working as expected, which will give you and your users confidence in the plugin. Adhering to a style convention, and checking that style with a tool like <code class="docutils literal notranslate"><span class="pre">flake8</span></code>, is very helpful for others who want to understand your code, including users who want an in depth understanding of the functionality and potential open source software contributors.</p>
<p><a class="reference external" href="http://journals.plos.org/plosbiology/article?id=10.1371/journal.pbio.1001745">Wilson et al. (2014)</a> present a good discussion of software testing and related topics that is very helpful for scientists who are beginning to develop and distribute software.</p>
</section>
<section id="advanced-plugin-development">
<h2>Advanced plugin development<a class="headerlink" href="#advanced-plugin-development" title="Permalink to this heading">#</a></h2>
<section id="defining-semantic-types-data-layouts-and-view-readers-writers">
<h3>Defining semantic types, data layouts, and view readers/writers<a class="headerlink" href="#defining-semantic-types-data-layouts-and-view-readers-writers" title="Permalink to this heading">#</a></h3>
<p>This section is currently incomplete. In the meantime, if you have questions about these advanced plugin development topics, feel free to get in touch with us on the <a class="reference external" href="https://forum.qiime2.org">forum</a>. For an example of a plugin that define semantic types, data layouts, and view readers/writers, see <a class="reference external" href="https://github.com/qiime2/q2-types">q2-types</a>.</p>
</section>
</section>
<section id="example-plugins">
<h2>Example plugins<a class="headerlink" href="#example-plugins" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/qiime2/q2-emperor">q2-emperor</a>: This is a simple plugin that is defined as a stand-alone package. It provides QIIME 2 access to functionality defined in <a class="reference external" href="https://github.com/biocore/emperor">Emperor</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/qiime2/q2-diversity">q2-diversity</a>: This is a more complex plugin, where the plugin is defined in the same package as the functionality that it’s providing access to.</p></li>
<li><p><a class="reference external" href="https://github.com/qiime2/q2-types">q2-types</a>: This is a more complex plugin defining real-world QIIME 2 types for bioinformatics/microbiome analyses.</p></li>
</ul>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./10-tutorial/10-plugins"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../00-intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="10-plugin-setup.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Instantiating the <cite>qiime2.plugin.Plugin</cite> object</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plugin-components">Plugin components</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-functionality">Define functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-function-to-register-as-a-method">Create a function to register as a Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-function-to-register-as-a-visualizer">Create a function to register as a Visualizer</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#instantiating-a-plugin">Instantiating a plugin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-an-action">Registering an Action</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-a-method">Registering a Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#registering-a-visualizer">Registering a Visualizer</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-your-plugin-object-as-an-entry-point">Defining your plugin object as an entry point</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-your-plugin-with-q2cli-during-development">Testing your plugin with q2cli during development</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plugin-testing">Plugin testing</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-plugin-development">Advanced plugin development</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-semantic-types-data-layouts-and-view-readers-writers">Defining semantic types, data layouts, and view readers/writers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-plugins">Example plugins</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By QIIME 2 Project
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>