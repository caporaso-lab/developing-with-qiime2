

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>File Formats and Directory Formats &#8212; Developing with QIIME 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'framework/explanations/formats';</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Decentralized retrospective provenance tracking" href="provenance.html" />
    <link rel="prev" title="Semantic Types, Primitives, and Visualizations" href="types.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/dwq2-light.png" class="logo__image only-light" alt="Developing with QIIME 2 - Home"/>
    <script>document.write(`<img src="../../_static/dwq2-dark.png" class="logo__image only-dark" alt="Developing with QIIME 2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Plugins 🔌</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../plugins/intro.html">Plugin Development</a><input checked class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../plugins/tutorials/intro.html">Tutorial: A step-by-step guide to building your first QIIME 2 plugin</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/create-from-template.html">Create your plugin from a template</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-nw-align-method.html">Add a first (real) Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-alignment-visualizer.html">Add a first Visualizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-artifact-class.html">Add a new Artifact Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-usage-examples.html">Add a Usage Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-2nd-transformer.html">Add a second transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/add-pipeline.html">Add a first Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/tutorials/conclusion.html">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../plugins/how-to-guides/intro.html">How-To Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/set-up-development-environment.html">Set up your development environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/register-a-plugin.html">Register a QIIME 2 plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/create-register-method.html">Create and register a Method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/create-register-visualizer.html">Create and register a visualizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/create-register-pipeline.html">Create and register a pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/create-register-transformer.html">Creating and registering a Transformer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/artifact-collections-as-io.html">Use Artifact Collections as Action inputs or outputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/play-nicely-with-others.html">How to play nicely with other plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/use-metadata.html">How to use Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/test-plugins.html">How to test QIIME 2 plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/usage-examples.html">Writing Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/how-to-guides/format-validation-levels.html">Defining different Format validation levels</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../plugins/explanations/intro.html">Explanations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/explanations/actions.html">Types of QIIME 2 Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/explanations/package-structure.html">The structure of QIIME 2 plugin packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/explanations/types-of-types.html">Semantic types, data types, file formats, and artifact classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/explanations/transformers.html">Transformers</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../plugins/references/intro.html">References</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/references/antipatterns.html">Plugin development anti-patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/references/api.html">Plugin developer API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../plugins/references/metadata-api.html"><code class="docutils literal notranslate"><span class="pre">qiime2.Metadata</span></code> API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Interfaces 🧩</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../interfaces/intro.html">Interface Development</a><input checked class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../interfaces/references/intro.html">References</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../interfaces/references/api.html">Interface developer API reference</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Framework 🌳</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../intro.html">Framework Development</a><input checked class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../how-to-guides/intro.html">How-To Guides</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../how-to-guides/parallel-configuration.html">Parallel configuration and usage in QIIME 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../how-to-guides/pipeline-resumption.html">Pipeline Resumption in QIIME 2</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="intro.html">Explanations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="architecture.html">QIIME 2 architecture overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="data-storage.html">How Data is Stored</a></li>
<li class="toctree-l3"><a class="reference internal" href="archives.html">Anatomy of an Archive</a></li>
<li class="toctree-l3"><a class="reference internal" href="types.html">Semantic Types, Primitives, and Visualizations</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">File Formats and Directory Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="provenance.html">Decentralized retrospective provenance tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="garbage-collection.html">Garbage Collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="metaprogramming.html">Metaprogramming</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../references/intro.html">References</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../references/archive-versions.html">Archive versions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation 📚</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../docs/intro.html">Docs Development</a><input checked class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../docs/user-documentation.html">User documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docs/developer-documentation.html">Developer documentation</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Continuous Integration 🛠️</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ci/intro.html">Distribution Development</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Back Matter 🗂️</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../back-matter/intro.html">Back matter</a><input checked class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../back-matter/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../back-matter/bibliography.html">List of works cited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../back-matter/genindex.html">Index</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/framework/explanations/formats.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>File Formats and Directory Formats</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#file-formats">File Formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation">Validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#text-file-formats">Text File Formats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-file-formats">Binary File Formats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-formats">Directory Formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-layouts">Fixed Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-layouts">Variable Layouts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-file-directory-formats">Single File Directory Formats</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#associating-formats-with-a-type">Associating Formats with a Type</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="file-formats-and-directory-formats">
<span id="formats-explanation"></span><h1>File Formats and Directory Formats<a class="headerlink" href="#file-formats-and-directory-formats" title="Permalink to this heading">#</a></h1>
<p><a class="reference internal" href="../../back-matter/glossary.html#term-Format"><span class="xref std std-term">Formats</span></a> in QIIME 2 are on-disk representations of data.
When associated with an <a class="reference internal" href="../../back-matter/glossary.html#term-Artifact-class"><span class="xref std std-term">artifact class</span></a>, they define how data are stored in or read from the <code class="docutils literal notranslate"><span class="pre">data/</span></code> directory of <a class="reference internal" href="../../back-matter/glossary.html#term-Artifact"><span class="xref std std-term">artifacts</span></a>.</p>
<p>QIIME 2 doesn’t have much of an opinion on how data should be represented or stored, so long as it <em>can</em> be represented or stored in an <a class="reference internal" href="../../back-matter/glossary.html#term-Archive"><span class="xref std std-term">archive</span></a>.</p>
<section id="file-formats">
<h2>File Formats<a class="headerlink" href="#file-formats" title="Permalink to this heading">#</a></h2>
<p>The simplest <code class="docutils literal notranslate"><span class="pre">Formats</span></code> are the <code class="docutils literal notranslate"><span class="pre">TextFileFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.TextFileFormat</span></code>) and the <code class="docutils literal notranslate"><span class="pre">BinaryFileFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.BinaryFileFormat</span></code>).
These formats represent a single file with a fixed on-disk representation.</p>
<section id="validation">
<span id="formats-validation-explanation"></span><h3>Validation<a class="headerlink" href="#validation" title="Permalink to this heading">#</a></h3>
<p>Both types of <code class="docutils literal notranslate"><span class="pre">FileFormat</span></code> support validation.
This is (typically) a small bit of code that is run when initially loading a file from an <a class="reference internal" href="../../back-matter/glossary.html#term-Archive"><span class="xref std std-term">archive</span></a> that allows the framework to ensure that the the data contained within the <a class="reference internal" href="../../back-matter/glossary.html#term-Archive"><span class="xref std std-term">archive</span></a> at least <em>looks</em> like its declared <a class="reference internal" href="../../back-matter/glossary.html#term-Type"><span class="xref std std-term">type</span></a>.
This works very well for on-the-fly loading and saving, and goes a long way to preventing corrupt or invalid data from persisting.
The one “gotcha” here is that in order to keep things quick, we typically recommend that “minimal” validation occurs over a limited subset of the file (e.g. the first 10 records in a FASTQ file).
Because of this, formats allow for multiple levels of sniffing to be defined.
As of this writing (March 2024) there currently there are two validation levels: <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code>.</p>
<p>Here we provide an example of a <code class="docutils literal notranslate"><span class="pre">TextFileFormat</span></code> definition, with a focus on the <code class="docutils literal notranslate"><span class="pre">_validate_</span></code> function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IntSequenceFormat</span><span class="p">(</span><span class="n">TextFileFormat</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A sequence of integers stored on new lines in a file.</span>
<span class="sd">    To make validation more interesting, values in the list can be any integer as long</span>
<span class="sd">    as that integer is not equal to the previous value plus 3</span>
<span class="sd">    (i.e., `line[i] != (line[i-1]) + 3`).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_validate_n_ints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">previous_val</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
                    <span class="c1"># we have passed the min validation level,</span>
                    <span class="c1"># so bail out</span>
                    <span class="k">break</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Line </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> contains </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">, but must be an integer.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">previous_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">previous_val</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">==</span> <span class="n">val</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Value on line </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2"> is 3 more than the value on &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;line </span><span class="si">{</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="n">previous_val</span> <span class="o">=</span> <span class="n">val</span>

    <span class="c1"># `_validate_` is exposed through the public method `validate`.</span>
    <span class="k">def</span> <span class="nf">_validate_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">):</span>
        <span class="n">record_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_n_ints</span><span class="p">(</span><span class="n">record_map</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>

<span class="n">format_instance</span> <span class="o">=</span> <span class="n">IntSequenceFormat</span><span class="p">(</span><span class="n">temp_dir</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">format_instance</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>  <span class="c1"># Shouldn&#39;t error!</span>
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">IntSequenceFormat</span></code> example, when <code class="docutils literal notranslate"><span class="pre">validate</span></code> is called with <code class="docutils literal notranslate"><span class="pre">level='min'</span></code>, <code class="docutils literal notranslate"><span class="pre">_validate_</span></code> will check the first 5 records.
Otherwise, when <code class="docutils literal notranslate"><span class="pre">level='max'</span></code>, it will check the entire file.</p>
<p>Astute observers might notice that the method defined in the <code class="docutils literal notranslate"><span class="pre">IntSequenceFormat</span></code> is called <code class="docutils literal notranslate"><span class="pre">_validate_</span></code>, but the method called on the <code class="docutils literal notranslate"><span class="pre">format_instance</span></code> was <code class="docutils literal notranslate"><span class="pre">validate</span></code>.
This is because defining format validation is optional (although highly recommended!).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We consider skipping validation all together when defining formats to be a plugin development anti-pattern.
For more information, see <a class="reference internal" href="../../plugins/references/antipatterns.html#antipattern-skipping-validation"><span class="std std-ref">Skipping format validation</span></a>.</p>
</div>
<p>Every format has a <code class="docutils literal notranslate"><span class="pre">validate</span></code> method available to interfaces (for performing ad-hoc validation).
The framework will check for the presence of a <code class="docutils literal notranslate"><span class="pre">_validate_</span></code> method on the format in question, and if it exists it will include that method as part of more general validations that the framework will perform.
The aim here is that the framework is capable of ensuring common basic patterns, like presence of required files, while the <code class="docutils literal notranslate"><span class="pre">_validate_</span></code> method is the place for the format developer to declare any special “business” logic necessary for ensuring the validity of their format.</p>
</section>
<section id="text-file-formats">
<h3>Text File Formats<a class="headerlink" href="#text-file-formats" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">TextFileFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.TextFileFormat</span></code>) is for creating text-based formats (e.g. FASTQ, TSV, etc.).
An example of one of these formats is the <a class="reference external" href="https://github.com/qiime2/q2-types/blob/e25f9355958755343977e037bbe39110cfb56a63/q2_types/feature_data/_format.py#L147"><code class="docutils literal notranslate"><span class="pre">DNAFASTAFormat</span></code></a>, used for storing FASTA data.</p>
</section>
<section id="binary-file-formats">
<h3>Binary File Formats<a class="headerlink" href="#binary-file-formats" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">BinaryFileFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.BinaryFileFormat</span></code>) is for creating binary formats (e.g. BIOM, gzip, etc.).
An example of one of these formats is the <a class="reference external" href="https://github.com/qiime2/q2-types/blob/e25f9355958755343977e037bbe39110cfb56a63/q2_types/per_sample_sequences/_format.py#L236"><code class="docutils literal notranslate"><span class="pre">FastqGzFormat</span></code></a>, a format for storing gzipped FASTQ files.</p>
</section>
</section>
<section id="directory-formats">
<h2>Directory Formats<a class="headerlink" href="#directory-formats" title="Permalink to this heading">#</a></h2>
<p>While many formats can accurately be described using a single file, many formats exist that require the presence of more than one file present together as a set.
QIIME 2 allows more than one <code class="docutils literal notranslate"><span class="pre">FileFormat</span></code> to be combined together as a <code class="docutils literal notranslate"><span class="pre">DirectoryFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.DirectoryFormat</span></code>).</p>
<section id="fixed-layouts">
<h3>Fixed Layouts<a class="headerlink" href="#fixed-layouts" title="Permalink to this heading">#</a></h3>
<p>Some directory layouts can be accurately described with a fixed number of members.
An example of this is the <a class="reference external" href="https://github.com/qiime2/q2-demux/blob/6e9a0cc8841a9cfbb5f517a256872700c7b75732/q2_demux/_format.py#L28"><code class="docutils literal notranslate"><span class="pre">EMPPairedEndDirFmt</span></code></a>.
This directory format is always composed of three <a class="reference external" href="https://github.com/qiime2/q2-types/blob/e25f9355958755343977e037bbe39110cfb56a63/q2_types/per_sample_sequences/_format.py#L236"><code class="docutils literal notranslate"><span class="pre">FastqGzFormat</span></code></a> files: one for the forward reads (<code class="docutils literal notranslate"><span class="pre">forward.fastq.gz</span></code>), one for the reverse reads (<code class="docutils literal notranslate"><span class="pre">reverse.fastq.gz</span></code>), and one for the barcodes (<code class="docutils literal notranslate"><span class="pre">barcodes.fastq.gz</span></code>).
The underlying <code class="docutils literal notranslate"><span class="pre">FastqGzFormat</span></code> is defined once — it doesn’t need to know about the sematic difference between biological reads and barcode reads, unlike the <code class="docutils literal notranslate"><span class="pre">EMPPairedEndDirFmt</span></code> which must be able to differentiate these.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="k">class</span> <span class="nc">EMPPairedEndDirFmt</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DirectoryFormat</span><span class="p">):</span>
       <span class="n">forward</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;forward.fastq.gz&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">FastqGzFormat</span><span class="p">)</span>
       <span class="n">reverse</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;reverse.fastq.gz&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">FastqGzFormat</span><span class="p">)</span>
       <span class="n">barcodes</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;barcodes.fastq.gz&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">FastqGzFormat</span><span class="p">)</span>
</pre></div>
</div>
<p>The component files of this <code class="docutils literal notranslate"><span class="pre">DirectoryFormat</span></code> are defined using the <code class="docutils literal notranslate"><span class="pre">File</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.model.File</span></code>) class.</p>
</section>
<section id="variable-layouts">
<h3>Variable Layouts<a class="headerlink" href="#variable-layouts" title="Permalink to this heading">#</a></h3>
<p>While some layouts are accurately described with a fixed set of members, others are highly variable, preventing formats from accurately knowing how many files to expect in its <a class="reference internal" href="../../back-matter/glossary.html#term-Payload"><span class="xref std std-term">payload</span></a>.
An example of this kind of format are any of the demultiplexed file formats — when sequences are demultiplexed there is one (or two) files per sample, but how many samples are there?
One study might have 5 samples, while another has 5000.
For these situations the <code class="docutils literal notranslate"><span class="pre">DirectoryFormat</span></code> (<code class="docutils literal notranslate"><span class="pre">qiime2.plugin.DirectoryFormat</span></code>) can be configured to watch for set pattern of filenames present in its <a class="reference internal" href="../../back-matter/glossary.html#term-Payload"><span class="xref std std-term">payload</span></a>.
An example of this is the <a class="reference external" href="https://github.com/qiime2/q2-types/blob/e25f9355958755343977e037bbe39110cfb56a63/q2_types/per_sample_sequences/_format.py#L292"><code class="docutils literal notranslate"><span class="pre">CasavaOneEightSingleLanePerSampleDirFmt</span></code></a> class, which stores demultiplexed sequence data in files named with a pattern used by Illumina’s Casava v1.8 software.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CasavaOneEightSingleLanePerSampleDirFmt</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DirectoryFormat</span><span class="p">):</span>
    <span class="n">sequences</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">FileCollection</span><span class="p">(</span>
        <span class="sa">r</span><span class="s1">&#39;.+_.+_L[0-9][0-9][0-9]_R[12]_001\.fastq\.gz&#39;</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="n">FastqGzFormat</span><span class="p">)</span>

    <span class="nd">@sequences</span><span class="o">.</span><span class="n">set_path_maker</span>
    <span class="k">def</span> <span class="nf">sequences_path_maker</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_id</span><span class="p">,</span> <span class="n">barcode_id</span><span class="p">,</span> <span class="n">lane_number</span><span class="p">,</span>
                            <span class="n">read_number</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%s</span><span class="s1">_L</span><span class="si">%03d</span><span class="s1">_R</span><span class="si">%d</span><span class="s1">_001.fastq.gz&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sample_id</span><span class="p">,</span> <span class="n">barcode_id</span><span class="p">,</span>
                                                <span class="n">lane_number</span><span class="p">,</span> <span class="n">read_number</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="single-file-directory-formats">
<h2>Single File Directory Formats<a class="headerlink" href="#single-file-directory-formats" title="Permalink to this heading">#</a></h2>
<p>Currently QIIME 2 requires that all formats registered to an <a class="reference internal" href="../../back-matter/glossary.html#term-Artifact-class"><span class="xref std std-term">artifact class</span></a> be a directory format.
For those cases, there exists a factory for quickly constructing directory layouts that contain <em>only a single file</em>.
This requirement might be removed in the future, but for now it is a necessary evil (and also isn’t too much extra work for format developers).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DNASequencesDirectoryFormat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">SingleFileDirectoryFormat</span><span class="p">(</span>
    <span class="s1">&#39;DNASequencesDirectoryFormat&#39;</span><span class="p">,</span> <span class="s1">&#39;dna-sequences.fasta&#39;</span><span class="p">,</span> <span class="n">DNAFASTAFormat</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="associating-formats-with-a-type">
<h2>Associating Formats with a Type<a class="headerlink" href="#associating-formats-with-a-type" title="Permalink to this heading">#</a></h2>
<p>Formats on their own aren’t of much use.
It is only once they are associated with a <a class="reference internal" href="../../back-matter/glossary.html#term-Semantic-Type"><span class="xref std std-term">semantic type</span></a> to define an <em>artifact class</em> that things become interesting.
Artifact classes define the data that can be provided as input or generated as output by QIIME 2 <code class="docutils literal notranslate"><span class="pre">Actions</span></code>.
An example of this can be seen in the <a class="reference external" href="https://github.com/qiime2/q2-types/blob/e25f9355958755343977e037bbe39110cfb56a63/q2_types/per_sample_sequences/_type.py#L66">registration of the <code class="docutils literal notranslate"><span class="pre">SampleData[PairedEndSequencesWithQuality]</span></code> artifact class</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./framework/explanations"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="types.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Semantic Types, Primitives, and Visualizations</p>
      </div>
    </a>
    <a class="right-next"
       href="provenance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Decentralized retrospective provenance tracking</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#file-formats">File Formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation">Validation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#text-file-formats">Text File Formats</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#binary-file-formats">Binary File Formats</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directory-formats">Directory Formats</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fixed-layouts">Fixed Layouts</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variable-layouts">Variable Layouts</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-file-directory-formats">Single File Directory Formats</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#associating-formats-with-a-type">Associating Formats with a Type</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Greg Caporaso and Evan Bolyen
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>